<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Eigen Application: Ellipse</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../../../../assets/css/main.css" />
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="../../../../index.html" class="logo">Machine Learning <strong>Cognitio</strong> </a>
									<!-- <ul class="icons">
										<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
										<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
										<li><a href="#" class="icon brands fa-snapchat-ghost"><span class="label">Snapchat</span></a></li>
										<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
										<li><a href="#" class="icon brands fa-medium-m"><span class="label">Medium</span></a></li>
									</ul> -->
								</header>

							<!-- Content -->
								<section>
									<header class="main">
										<h1>Eigen Application: Ellipse</h1>
									</header>

                                    <p style="text-align: justify; font-size: 17px;">
                                        An ellipse looks like a squashed circle , usually we represent an ellipse with respect to the cartesian coordinate system
                                        having a semi major axsis - <span lang='latex'>\large a</span> and a semi minor axsis - <span lang='latex'>\large b</span>. 
                                        Then the equation of the ellipse can be written as below and let them be equation <span lang='latex'>\large (1)</span>.
                                        
                                        <div style='text-align: center'>
                                            <img src="../images/ellipse.png" width="600" height="300"/>
                                        </div>

                                        <div lang='latex' style='text-align: center;'>
                                            \large 
                                            \dfrac{x^{2}}{a^{2}} + \dfrac{y^{2}}{b^{2}} = 1 \hspace{10mm}(1)
                                        </div>
                                    </p>

                                    <p style="text-align: justify; font-size: 17px;">
                                        where <span lang='latex'>\large a > b</span> and the longest diameter is <span lang='latex'>\large 2a</span> and the shortest diameter is <span lang='latex'>\large 2b</span>. Now, let's say 
                                        if a circle is not squished in the direction of <span lang='latex'>\large x-axis</span> or <span lang='latex'>\large y-axis</span> but in some other 
                                        direction leaving us with the following questions, 
                                        <ol style="text-align: justify; font-size: 17px;">
                                            <li>What will be the equation of the ellipse then?</li>
                                            <li>How to figure out what are the semi-major axis and semi-minor axis of the ellipse?</li>
                                        </ol>
                                    </p>

                                    <p style="text-align: justify; font-size: 17px;">
                                        To answer let's represent the ellipse with it's general equation as below and then find the eigen values and eigen vectors of the coefficients in the equation.
                                        
                                        <div lang='latex' style='text-align: center'>
                                            \large 
                                            Ax^{2} + Bxy + Cy^{2} = 1
                                        </div>
                                    </p>

                                    <p style="text-align: justify; font-size: 17px;">
                                        The above equation is quadratic equation and it will represent an ellipse if and only if the equation is an positive definite i.e,  
                                        <div lang='latex' style='text-align: center'>
                                            \large 
                                            \{ 
                                                \begin{bmatrix} 
                                                    x \\
                                                    y
                                                \end{bmatrix}
                                                \in 
                                                \mathbb{R}^{2} : 
                                                Ax^{2} + Bxy + Cy^{2} = 1
                                            \} \\                                             
                                        </div>

                                        <div lang='latex' style='text-align: center'>
                                        where \hspace{1.5mm} A, B, C \hspace{1.5mm} give \hspace{1.5mm} a \hspace{1.5mm} positive \hspace{1.5mm}  definate \hspace{1.5mm} quadratic \hspace{1.5mm} form. 
                                        </div>
                                    </p>

                                    <p style="text-align: justify; font-size: 17px;">
                                        In other words, A, B, C can't be negative numbers. Next, we will represent a quadratic equation in it's matrix form, 

                                        <div lang='latex' style='text-align: center'>
                                            \large 
                                            \overrightarrow{v} = \begin{bmatrix} x \\ y\end{bmatrix} 
                                            \hspace{5mm}
                                            M = \begin{bmatrix}
                                            A & \dfrac{B}{2}\\
                                            \dfrac{B}{2}& C \\
                                            \end{bmatrix}
                                        </div>
                                        <br>
                                        <div lang='latex' style='text-align: center'>
                                            \large 
                                            \overrightarrow{v}^{T}M\overrightarrow{v} = \begin{bmatrix} x & y \end{bmatrix}      
                                            \begin{bmatrix}
                                            A & \dfrac{B}{2} \\
                                            \dfrac{B}{2} & C \\
                                            \end{bmatrix}
                                            \begin{bmatrix} x \\ y\end{bmatrix}
                                        </div>  
                                        <br>
                                        <div lang='latex' style='text-align: center'>
                                            \large 
                                            \overrightarrow{v}^{T}M\overrightarrow{v} =
                                            \begin{bmatrix} x & y \end{bmatrix} 
                                            \begin{bmatrix}
                                                Ax + y \dfrac{B}{2} \\
                                                x \dfrac{B}{2} + Cy \\
                                            \end{bmatrix}
                                        </div>
                                        <br>
                                        <div lang='latex' style='text-align: center'>
                                            \large 
                                            \overrightarrow{v}^{T}M\overrightarrow{v} = Ax^{2} + Bxy + Cy^{2}
                                        </div>                                        
                                    </p>
                                </section>

                                <section>
                                    <h2>Relation between the eigen values and major & minor axis</h2>


									<p style="text-align: justify; font-size: 17px;">

										Before we find the relation between the eigen values and major & minor axis let's prove a lemma. Which will later be used in finding the relation. 
										<br><br>

										<strong><u>Lemma:</u></strong> If <span lang='latex'>\large M</span> is a symmeteric matrix <span lang='latex'>\large (M^{T} = M)</span> and it's eigen values <span lang='latex'>\large \lambda_{1}, \lambda_{2}</span> are distinct then 
										the correspoinding eigen vectors (<span lang='latex'>\large \overrightarrow{u_{1}}, \overrightarrow{u_{2}}</span>)are orthogonal. Assuming <span lang='latex'>\large M</span> is of <span lang='latex'>\large (2 \times 2)</span> 
										dimension. 

										<br><br>

										<strong><u>Proof:</u></strong>  
										<div lang='latex' style='text-align: center;'>
											\large 
											M \overrightarrow{v}_{1} = \lambda_{1} \overrightarrow{v}_1,  \hspace{4mm} M \overrightarrow{v}_{2} = \lambda_{2} \overrightarrow{v}_2
										</div>

										<p style="text-align: justify; font-size: 17px;">
											Consider the expression:- 

											<div lang='latex' style='text-align: center;'>
												\large 
												\overrightarrow{u}_{1}^{T} M \overrightarrow{u}_{2} = \overrightarrow{u}_{1}^{T} \lambda_{2} \overrightarrow{u}_{2} = \lambda_{2} \overrightarrow{u}_{1}^{T} \overrightarrow{u}_{2} = \lambda_{2} \overrightarrow{u}_{1} . \overrightarrow{u}_{2}
											</div>																						
											
											<p style="text-align: justify; font-size: 17px;">
												As <span lang='latex'>\large (M^{T} = M)</span> symmeteric matrix, 

												<div lang='latex' style='text-align: center;'>
													\large 
													\overrightarrow{u}_{1}^{T} M \overrightarrow{u}_{2} = \overrightarrow{u}_{1}^{T} M^{T} \overrightarrow{u}_{2} = (M \overrightarrow{u}_{1})^{T} \overrightarrow{u}_{2} = \lambda_{1} \overrightarrow{u}_{1}^{T} \overrightarrow{u}_{2} = \lambda_{1} \overrightarrow{u}_{1} . \overrightarrow{u}_{2}
												</div>
											</p>
										</p>
									</p>

									<p style="text-align: justify; font-size: 17px;">
										equating the above two eqauations we get, 
										<div lang='latex' style='text-align: center;'>
											\large 
											\lambda_{2} \overrightarrow{u}_{1} . \overrightarrow{u}_{2} = \lambda_{1} \overrightarrow{u}_{1} . \overrightarrow{u}_{2} 
										</div>
										<br>
										<div lang='latex' style='text-align: center;'>
											\large 
											(\lambda_{2} - \lambda{1}) \overrightarrow{u}_{1} . \overrightarrow{u}_2 = 0
										</div>
									</p>

									<p style="text-align: justify; font-size: 17px;">
										As mentioned earlier <span lang = 'latex'>\large \lambda_{1}</span> and <span lang='latex'>\large \lambda_{2}</span> are distinct then <span lang='latex'>\large (\lambda_{2} - \lambda_{1})</span> can't be <span lang='latex'>\large 0</span>
										hence proving that the eigen vectors <span lang='latex'>\large \overrightarrow{u}_1</span> and <span lang='latex'>\large \overrightarrow{u}_2</span> are orthogonal that is there dot product is <span lang='latex'>\large 0</span>. 

										<div lang="latex" style='text-align: center;'>
											\large 
											\overrightarrow{u}_1 . \overrightarrow{u}_2 = 0
										</div>
									</p>

									<p style="text-align: justify; font-size: 17px;">

										Now let's use the above lemma to prove the theorem given below which will give us the relation between eigen values and the major axis & minor axis of an ellipse. 
										<br><br>
										<strong><u>Theorem:</u></strong> if the new major and minor axis point along the direction of the eigen vectors 
										(<span lang='latex'>\large \overrightarrow{u_{1}}</span> and <span lang='latex'>\large \overrightarrow{u_{2}}</span>) of the matrix 
										, 
                                        <div lang='latex' style='text-align: center'>
                                            \large 
                                            M = \begin{bmatrix}
                                            A & \dfrac{B}{2} \\
                                            \dfrac{B}{2} & C \\
                                            \end{bmatrix}
                                        </div> 		
										<br>
										<p style="text-align: justify; font-size: 17px;">
											where <span lang='latex'>\large \overrightarrow{u_{1}}</span> and <span lang='latex'>\large \overrightarrow{u_{2}}</span> are normalized 
											vectors having length <span lang='latex'>\large 1</span> and are the basis vectors of the new coordinate system. Then the equation of ellipse 
											becomes, 

											<div lang='latex' style='text-align: center'>
												\large 
												\lambda_{1} x^{2} + \lambda_{2} y^{2} = 1
											</div>
										</p>
										<p style="text-align: justify; font-size: 17px;">
											where, <span lang='latex'>\large \lambda_{1}</span> and <span lang='latex'>\large \lambda_{2}</span> are the eigen values of the matrix <span lang='latex'>\large M</span>. 
									</p>

									<p style="text-align: justify; font-size: 17px;">
										<strong><u>Proof:</u></strong> Let's take a vector <span lang='latex'>\large \begin{bmatrix}x \\ y\end{bmatrix}</span> in the standard coordinate system and perform change of basis to the coordinate system 
										of the eigen vectors to get <span lang='latex'>\large \overrightarrow{v}</span> as shown below, 
										<div lang='latex' style='text-align: center'>
											\large 
											\overrightarrow{v} = \begin{bmatrix}\overrightarrow{u}_1 & \overrightarrow{u}_2\end{bmatrix} \begin{bmatrix}x \\ y\end{bmatrix}
										</div>
										<br>
										<div lang='latex' style='text-align: center'>
											\large 
											\overrightarrow{v} = x \overrightarrow{u}_{1} + y \overrightarrow{u}_2
										</div>	
										<br>
										<div lang='latex' style='text-align: center'>
											\large 
											\overrightarrow{v}^{T} M \overrightarrow{v} = (x \overrightarrow{u}_{1} + y \overrightarrow{u}_2)^T M (x \overrightarrow{u}_{1} + y \overrightarrow{u}_2) \\
										</div>	
										<br>
										<div lang='latex' style='text-align: center'>
											\large 
											\overrightarrow{v}^{T} M \overrightarrow{v} = (x\overrightarrow{u}_{1} + y \overrightarrow{u}_2)^T (M x \overrightarrow{u}_{1} + M y \overrightarrow{u}_2)
										</div>	
										<br>
										<div lang='latex' style='text-align: center'>
											\large 
											\overrightarrow{v}^{T} M \overrightarrow{v} = (x\overrightarrow{u}_{1} + y \overrightarrow{u}_2)^T (x M \overrightarrow{u}_{1} + y M \overrightarrow{u}_2)
										</div>		
										<br>
										<div lang='latex' style='text-align: center'>
											\large 
											\overrightarrow{v}^{T} M \overrightarrow{v} = (x\overrightarrow{u}_{1} + y \overrightarrow{u}_2)^T (x \lambda_{1} \overrightarrow{u}_{1} + y \lambda_{2} \overrightarrow{u}_2)
										</div>		
										<br>
										<p style="text-align: justify; font-size: 17px;">
											As <span lang='latex'>\large \overrightarrow{u}_{1}</span> and  <span lang='latex'>\large \overrightarrow{u}_{2}</span> are unit vectors and  <span lang='latex'>\large \overrightarrow{u}_1 . \overrightarrow{u}_2 = 0</span> the above equation can be simplified as, 

											<div lang='latex' style='text-align: center'>
												\large 
												\overrightarrow{v}^{T} M \overrightarrow{v} = x^{2} \lambda_{1} + x y \lambda_{2} \overrightarrow{u}_{1}^{T} . \overrightarrow{u}_{2} + x y \lambda_{1} \overrightarrow{u}_{2}^{T}. \overrightarrow{u}_{1} + y^{2} \lambda_{2}
											</div>
											<br>
											<div lang='latex' style='text-align: center'>
												\large 
												\overrightarrow{v}^{T} M \overrightarrow{v} = x^{2} \lambda_{1} + y^{2} \lambda_{2}
											</div>			
											<br>
											<div lang='latex' style='text-align: center'>
												\large 
												\overrightarrow{v}^{T} M \overrightarrow{v} = \dfrac{x^{2}}{(\dfrac{1}{\sqrt{\lambda_{1}}})^2} + \dfrac{y^{2}}{(\dfrac{1}{\sqrt{\lambda_{2}}})^2} \hspace{5mm} (2)
											</div>												
										</p>
										<p style="text-align: justify; font-size: 17px;">
											Now using the equation <span lang='latex'>\large (1)</span> defined at the begining of this tutorial we can compare equation <span lang='latex'>\large (2)</span> given above as, 

											<div lang='latex' style='text-align: center'>
												\large 
												a = \dfrac{1}{\sqrt{\lambda_{1}}} \hspace{5mm} b = \dfrac{1}{\sqrt{\lambda_{2}}}
											</div>
										</p>

										<p style="text-align: justify; font-size: 17px;">
											From the above equation we can see the relation between eigen values and axes of ellipse. The major axis corresponds to small eigen value while the minor axis to the big 
											eigen value. The eigen vectors of the ellipse tell you at which direction the ellipse is being squished in and eigen values tell you how much it is squished in (from a circle as it's initial shape).
											So, this tells us given an positive definite quadratic equation how to calculate the ellipse equation from it. In the next section we will see how to find the ellipse equation and length of the axes 
											given a positive definite quadratic equation. 
										</p>
									</p>

                                </section>

								<section>
									<h2>Calculate the equation of the ellipse given an positive definite quadratic equation</h2>

									<p style="text-align: justify; font-size: 17px;">
										Let's take the matrix notation of an quadratic equation and assume the quadratic equation to be in positive definite form 
										as shown below, 
										<div lang='latex' style="text-align: center">
											\large 
											x^{T}Mx = 1\hspace{10mm} (3)
										</div>									
									</p>

									<p style="text-align: justify; font-size: 17px;">
										Where <span lang='latex'>\large M</span> consitutes the coefficients of the general equation of the ellipse which is 
										<span lang='latex'>\large Ax^{2} + Bxy + Cy^{2} = 1</span> as shown below, 

										<div lang='latex' style='text-align: center;'>
											M = \begin{bmatrix}
                                            A & \dfrac{B}{2}\\
                                            \dfrac{B}{2}& C \\
                                            \end{bmatrix}
										</div>
									</p>
									
									<p style="text-align: justify; font-size: 17px;">
										Next we perform the eigen decomposition of the matrix <span lang='latex'>\large M</span> assuming <span lang='latex'>\large M</span> is of dimension <span lang='latex'>\large (2 \times 2)</span>
										to get the following representation of the equation <span lang='latex'>\large (3)</span>.

										<div lang='latex' style="text-align: center">
											\large 
											x^{T}Mx = x^{T} \begin{bmatrix} e_{1} & e_{2} \end{bmatrix} \begin{bmatrix} \lambda_{1} & 0 \\ 0 & \lambda_{2} \end{bmatrix} \begin{bmatrix} e_{1} \\ e_{2} \end{bmatrix} x  = 1
										</div>
									</p>

									<p style="text-align: justify; font-size: 17px;">
										where <span lang='latex'>\large e_{1}</span> and <span lang='latex'>\large e_{2}</span> are the eigen vectors and the corresponding eigen values are <span lang='latex'>\large \lambda_{1}</span> and <span lang='latex'>\large \lambda_{2}</span> 
										of the matrix <span lang='latex'>\large M</span>. If we solve the above equation we get, 

										<div lang='latex' style="text-align: center">
											\large 
											x^{T}Mx = \lambda_{1} x^{T} e_{1} e_{1}^{T} x + \lambda_{2} x^{T} e_{2} e_{2}^{T} x = 1
										</div>		
										<br>
										<div lang='latex' style="text-align: center">
											\large 
											x^{T}Mx = \lambda_{1} (e_{1}^{T} x)^T e_{1}^{T} x + \lambda_{2} (e_{2}^{T} x)^{T} e_{2}^{T} x = 1
										</div>		
										<br>
										<div lang='latex' style="text-align: center">
											\large 
											x^{T}Mx = \lambda_{1} (e_{1}^{T} x)^{2} + \lambda_{2} (e_{2}^{T} x)^{2} = 1
										</div>
										<br>
										<div lang='latex' style="text-align: center">
											\large 
											\dfrac{(e_{1}^{T} x)^{2}}{(\dfrac{1}{\sqrt{\lambda_{1}}})^{2}} + \dfrac{(e_{2}^{T} x)^{2}}{(\dfrac{1}{\sqrt{\lambda_{2}}})^{2}} = 1
										</div>										
									</p>

									<p style="text-align: justify; font-size: 17px;">
										From the above equation we can see the similarity to equation <span lang='latex'>\large (1)</span> and 
										<span lang='latex'>\large (2)</span>. We will use what you have learnt in this tutorial and the next tutorial (Taylor expansion) to understand 
										and derieve the harris corner detection equation. 
									</p>

								</section>
						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">

							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li><a href="../home_page.html">Harris Corner Detection</a></li>
										<li><a href="../sub_topics/change_of_basis.html">I. Change of Basis</a></li>
										<li><a href="../sub_topics/eigen_values_vectors.html">II. Eigen Values and Eigen Vectors</a></li>
										<li><a href="../sub_topics/eigen_decomposition.html">III. Eigen Decomposition (Diagonalization)</a></li>
										<li><a href="../sub_topics/ellipse.html">IV. Eigen Application: Ellipse</a></li>
										<li><a href="../sub_topics/taylor_expansion.html">V. Taylor Expansion</a></li>
                                        <li><a href="../sub_topics/theory.html">VI. Harris Corner Detection (Theory)</a></li>
                                        <li><a href="../sub_topics/pratical.html">VII. Harris Corner Detection (Practical)</a></li>
									</ul>
								</nav>

							<!-- Section -->
							<section>
								<header class="major">
									<h2>About the Author</h2>
								</header>
								<p>The author of the blog is Akshath Varugeese. You can find more about him <a href="https://akshath123.github.io/About_Me/">here</a>.</p>
							</section>

						<!-- Footer -->
							<footer id="footer">
								<p class="copyright">&copy; Machine Learning Cognitio. All rights reserved.</p>
							</footer>
						</div>
					</div>

			</div>

		<!-- Scripts -->
			<script src="../../../../assets/js/jquery.min.js"></script>
			<script src="../../../../assets/js/browser.min.js"></script>
			<script src="../../../../assets/js/breakpoints.min.js"></script>
			<script src="../../../../assets/js/util.js"></script>
			<script src="../../../../assets/js/main.js"></script>
			<script type="text/javascript" src="http://latex.codecogs.com/latexit.js"></script>			            

	</body>
</html>